(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";

var _excluded = ["data"],
    _excluded2 = ["caller", "callee"];

function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }

function _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, "next", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, "throw", err); } _next(undefined); }); }; }

addEventListener('DOMContentLoaded', function () {
  var localVideo = document.getElementById('localWebRTC');
  var remoteVideo = document.getElementById('remoteWebRTC');
  var btnStart = document.getElementById("btn-video-start");
  var btnStop = document.getElementById("btn-video-stop");
  var callButton = document.getElementById('btn-video-call'); //возможные ограничения

  var constraints = {
    video: {
      advanced: [{
        height: 150
      }],
      height: 300,
      width: 300
    },
    audio: true
  };
  var iceServers = [{
    urls: "turn:bot.ruitb.ru:5349?transport=tcp",
    username: "telemed1",
    credential: "Lomwe675Df",
    credentialType: "password"
  }, {
    urls: "stun:stun.stunprotocol.org"
  }, {
    urls: "turn:bot.ruitb.ru:5349",
    username: "telemed1",
    credential: "Lomwe675Df",
    credentialType: "password"
  }, {
    urls: "turn:bot.ruitb.ru:3478",
    username: "telemed1",
    credential: "Lomwe675Df",
    credentialType: "password"
  }, {
    urls: "stun:bot.ruitb.ru:3478",
    username: "telemed1",
    credential: "Lomwe675Df",
    credentialType: "password"
  }];
  var videoClose;
  btnStart.addEventListener("click", videoStart, false);
  btnStop.addEventListener('click', function () {
    typeof videoClose === 'function' && videoClose();
  });
  /*------------------------------------------------------------------------------------------------------------------------------------------*/

  /*------------------------------------------------------------------------------------------------------------------------------------------*/

  function videoStart() {
    return _videoStart.apply(this, arguments);
  }

  function _videoStart() {
    _videoStart = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4() {
      var mediaStream, videoTracks, audioContext;
      return regeneratorRuntime.wrap(function _callee4$(_context4) {
        while (1) {
          switch (_context4.prev = _context4.next) {
            case 0:
              _context4.next = 2;
              return navigator.mediaDevices.getUserMedia({
                video: {
                  brightness: 200,
                  height: 500
                },
                audio: true
              });

            case 2:
              mediaStream = _context4.sent;
              videoTracks = mediaStream.getVideoTracks()[0];

              videoClose = function videoClose() {
                videoTracks.stop();
              };

              audioContext = useAudioContext(mediaStream);
              localVideo.srcObject = mediaStream;
              createConnectP2P(mediaStream);

            case 8:
            case "end":
              return _context4.stop();
          }
        }
      }, _callee4);
    }));
    return _videoStart.apply(this, arguments);
  }

  function createConnectP2P(mediaStream) {
    var peerConnection = new RTCPeerConnection({
      iceServers: iceServers,
      iceTransportPolicy: 'relay'
    });
    var dataChanel = peerConnection.createDataChannel('testChanel');
    mediaStream.getTracks().forEach(function (track) {
      return peerConnection.addTrack(track, mediaStream);
    });
    /*#########----------<{ Event Chanel }>---------###########*/
    //Открывается соединение после обмена offer, answer  

    dataChanel.addEventListener('open', function (e) {
      console.dir('Канал открыт');
    });
    dataChanel.addEventListener('message', function (e) {
      console.log('Message: ', e.data);
    });
    peerConnection.addEventListener('datachannel', function (e) {
      console.dir('Передача канала');
    });
    peerConnection.addEventListener('track', function (e) {
      console.log('Получение track', e);
      remoteVideo.srcObject = e.streams[0];
    });
    /*#########----------<{ Event peerConnection }>---------###########
      icecandidate - отрабатывает если вызвали createOffer и передали данные в 
                     peerConnection.setLocalDescription(offerMetaData)
    */

    peerConnection.addEventListener('negotiationneeded', function (e) {
      console.dir(e);
    });
    createWebSocketConnect(peerConnection);
  }
  /*------------------------------------------------------------------------------------------------------------------------------------------*/


  function createWebSocketConnect(peerConnection) {
    var socket = new WebSocket("ws://localhost:4000");
    socket.addEventListener('close', function (e) {
      console.log('Соединение с сервером WS разорвано');
    });
    socket.addEventListener('error', function (e) {
      console.log('Ошибка соединения с сервером WS разорвано');
    });
    socket.addEventListener('open', function (e) {
      console.log('Соединение с сервером WS установленно');
      var clientId = uuid4(); // caller - вызывающий, callee - вызываемый

      console.log(clientId, 'clientId');

      var sendWS = function sendWS(payload) {
        socket.send(JSON.stringify(payload));
      };

      sendWS({
        type: 'peer',
        clientId: clientId,
        room: ''
      });
      peerConnection.addEventListener('icecandidate', function (e) {
        e.candidate && sendWS({
          type: 'candidate',
          candidate: e.candidate
        });
      });
      socket.addEventListener('message', /*#__PURE__*/function () {
        var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(_ref) {
          var data, e;
          return regeneratorRuntime.wrap(function _callee$(_context) {
            while (1) {
              switch (_context.prev = _context.next) {
                case 0:
                  data = _ref.data, e = _objectWithoutProperties(_ref, _excluded);
                  data = JSON.parse(data);
                  _context.t0 = data.type;
                  _context.next = _context.t0 === 'peer' ? 5 : _context.t0 === 'initID' ? 7 : _context.t0 === 'candidate' ? 9 : _context.t0 === 'offer' ? 11 : _context.t0 === 'answer' ? 13 : 15;
                  break;

                case 5:
                  data.clientId !== clientId && sendWS({
                    type: 'initID',
                    caller: clientId,
                    callee: data.clientId
                  });
                  return _context.abrupt("break", 16);

                case 7:
                  data.caller === clientId && createOffer(peerConnection, sendWS, data);
                  return _context.abrupt("break", 16);

                case 9:
                  peerConnection.addIceCandidate(data.candidate);
                  return _context.abrupt("break", 16);

                case 11:
                  data.callee === clientId && createAnswer(peerConnection, sendWS, data);
                  return _context.abrupt("break", 16);

                case 13:
                  data.caller === clientId && peerConnection.setRemoteDescription(data);
                  return _context.abrupt("break", 16);

                case 15:
                  return _context.abrupt("break", 16);

                case 16:
                case "end":
                  return _context.stop();
              }
            }
          }, _callee);
        }));

        return function (_x) {
          return _ref2.apply(this, arguments);
        };
      }());
    });
  }
  /*--------------------------------------------------------------------------------------------------------------*/


  var createOffer = /*#__PURE__*/function () {
    var _ref4 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(peerC, sendWS, _ref3) {
      var caller, callee, _yield$peerC$createOf, type, sdp;

      return regeneratorRuntime.wrap(function _callee2$(_context2) {
        while (1) {
          switch (_context2.prev = _context2.next) {
            case 0:
              caller = _ref3.caller, callee = _ref3.callee;
              peerC.clientID = {
                caller: caller,
                callee: callee
              };
              _context2.next = 4;
              return peerC.createOffer({
                offerToReceiveAudio: true,
                offerToReceiveVideo: true
              });

            case 4:
              _yield$peerC$createOf = _context2.sent;
              type = _yield$peerC$createOf.type;
              sdp = _yield$peerC$createOf.sdp;
              _context2.next = 9;
              return peerC.setLocalDescription({
                type: type,
                sdp: sdp
              });

            case 9:
              sendWS({
                type: type,
                sdp: sdp,
                caller: caller,
                callee: callee
              });

            case 10:
            case "end":
              return _context2.stop();
          }
        }
      }, _callee2);
    }));

    return function createOffer(_x2, _x3, _x4) {
      return _ref4.apply(this, arguments);
    };
  }();

  var createAnswer = /*#__PURE__*/function () {
    var _ref6 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(peerC, sendWS, _ref5) {
      var caller, callee, dataPeer, _yield$peerC$createAn, type, sdp;

      return regeneratorRuntime.wrap(function _callee3$(_context3) {
        while (1) {
          switch (_context3.prev = _context3.next) {
            case 0:
              caller = _ref5.caller, callee = _ref5.callee, dataPeer = _objectWithoutProperties(_ref5, _excluded2);
              peerC.clientID = {
                caller: caller,
                callee: callee
              };
              _context3.next = 4;
              return peerC.setRemoteDescription(dataPeer);

            case 4:
              _context3.next = 6;
              return peerC.createAnswer();

            case 6:
              _yield$peerC$createAn = _context3.sent;
              type = _yield$peerC$createAn.type;
              sdp = _yield$peerC$createAn.sdp;
              _context3.next = 11;
              return peerC.setLocalDescription({
                type: type,
                sdp: sdp
              });

            case 11:
              sendWS({
                type: type,
                sdp: sdp,
                caller: caller,
                callee: callee
              });

            case 12:
            case "end":
              return _context3.stop();
          }
        }
      }, _callee3);
    }));

    return function createAnswer(_x5, _x6, _x7) {
      return _ref6.apply(this, arguments);
    };
  }();
});
/*------------------------------------------------------------------------------------------------------------------------------------------ */

var optionsAudio = {
  filter: {
    type: 'highpass',
    frequency: 10000
  },
  gain: {
    value: 0.5
  }
};

function useAudioContext(mediaStream) {
  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : optionsAudio;
  var filter = options.filter,
      gain = options.gain;
  var audioContext = new AudioContext();
  var audioStream = audioContext.createMediaStreamSource(mediaStream);
  var audioFilter = audioContext.createBiquadFilter();
  audioFilter.type = filter.type;
  audioFilter.frequency.value = filter.frequency;
  var audioGain = audioContext.createGain();
  audioGain.gain.value = gain.value;
  audioStream.connect(audioFilter.connect(audioGain));
  return audioContext;
}
/*
  Blob можно превратить в URL такого вида:
  blob:http://127.0.0.1:5500/ac67d59c-3e02-4cb2-a0df-33a53afeeb2c

  Способ сделать фото с камеры:
      let capture = new ImageCapture(videoTrack);
      capture.takePhoto().then(async (blob)=>{
        let objectURL = URL.createObjectURL(blob);
        console.dir(objectURL);
        elImg.setAttribute('src', objectURL)
      })
*/

/*#########--------<{ WebSocked }>------####### 
extensions: ""
onclose: null
onerror: null
onmessage: null
onopen: null//отрабатывает если есть подключение к ws серверу
//методы
send
close
*/
// function createWebSocketConnect(peerConnection){
//   let socket = new WebSocket("ws://localhost:4000");
//   socket.addEventListener('close', (e) => { console.log('Соединение с сервером WS разорвано'); });
//   socket.addEventListener('error', (e) => { console.log('Ошибка соединения с сервером WS разорвано'); });
//   socket.addEventListener('open',  (e) => {
//     console.log('Соединение с сервером WS установленно'); 
//     let clientId = uuid4();     // caller - вызывающий, callee - вызываемый
//     console.log(clientId, 'clientId');
//     const sendWS = (payload) => { socket.send(JSON.stringify(payload)) }
//     sendWS({ type: 'peer', clientId, room: '' });
//     peerConnection.addEventListener('icecandidate', (e) => {
//       (e.candidate) && sendWS({ type: 'candidate', candidate: e.candidate });
//     })
//     socket.addEventListener('message', async ({data, ...e}) => {
//       data = JSON.parse(data);
//       switch (data.type) {
//         case 'peer': (data.clientId !== clientId) && sendWS({type: 'initID', caller: clientId, callee: data.clientId }); break;
//         case 'initID': (data.caller === clientId) && createOffer(peerConnection, sendWS, data); break;          
//         case 'candidate': peerConnection.addIceCandidate(data.candidate); break;      
//         case 'offer': (data.callee === clientId) && createAnswer(peerConnection, sendWS, data); break;
//         case 'answer': (data.caller === clientId) && peerConnection.setRemoteDescription(data); break;
//         default: break;
//       }
//     })
//   })
// }


function uuid4() {
  function hex(s, b) {
    return s + (b >>> 4).toString(16) + // high nibble
    (b & 15).toString(16); // low nibble
  }

  var r = crypto.getRandomValues(new Uint8Array(16));
  r[6] = r[6] >>> 4 | 64; // Set type 4: 0100

  r[8] = r[8] >>> 3 | 128; // Set variant: 100

  return r.slice(0, 4).reduce(hex, '') + r.slice(4, 6).reduce(hex, '-') + r.slice(6, 8).reduce(hex, '-') + r.slice(8, 10).reduce(hex, '-') + r.slice(10, 16).reduce(hex, '-');
}

},{}],2:[function(require,module,exports){
"use strict";

function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }

function _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, "next", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, "throw", err); } _next(undefined); }); }; }

addEventListener('DOMContentLoaded', function () {
  var localVideo = document.getElementById('localWebRTC');
  var remoteVideo = document.getElementById('remoteWebRTC');
  var btnStart = document.getElementById("btn-video-start");
  var btnStop = document.getElementById("btn-video-stop");
  var callButton = document.getElementById('btn-video-call');
  var selectChanel = document.getElementById('select-rtc-chanel'); //возможные ограничения

  var constraints = {
    video: {
      advanced: [{
        height: 150
      }],
      height: 300,
      width: 300
    },
    audio: true
  };
  var iceServers = [{
    urls: "turn:bot.ruitb.ru:5349?transport=tcp",
    username: "telemed1",
    credential: "Lomwe675Df",
    credentialType: "password"
  }, {
    urls: "stun:stun.stunprotocol.org"
  }, {
    urls: "turn:bot.ruitb.ru:5349",
    username: "telemed1",
    credential: "Lomwe675Df",
    credentialType: "password"
  }, {
    urls: "turn:bot.ruitb.ru:3478",
    username: "telemed1",
    credential: "Lomwe675Df",
    credentialType: "password"
  }, {
    urls: "stun:bot.ruitb.ru:3478",
    username: "telemed1",
    credential: "Lomwe675Df",
    credentialType: "password"
  }];
  var disconnect;
  var connection = true;
  btnStart.addEventListener("click", function () {
    connection && p2pConnect();
  });
  btnStop.addEventListener('click', function () {
    typeof disconnect === 'function' && disconnect();
    connection = true;
  });
  /*------------------------------------------------------------------------------------------------------------------------------------------*/

  /*------------------------------------------------------------------------------------------------------------------------------------------*/

  function p2pConnect() {
    return _p2pConnect.apply(this, arguments);
  }

  function _p2pConnect() {
    _p2pConnect = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4() {
      var peerConnection, socket, mediaStream, tracks;
      return regeneratorRuntime.wrap(function _callee4$(_context4) {
        while (1) {
          switch (_context4.prev = _context4.next) {
            case 0:
              connection = false;
              peerConnection = createConnectP2P();
              socket = createWebSocketConnect(peerConnection);
              _context4.next = 5;
              return navigator.mediaDevices.getUserMedia({
                video: {
                  brightness: 200,
                  height: 500
                },
                audio: true
              });

            case 5:
              mediaStream = _context4.sent;
              tracks = mediaStream.getTracks(); // localVideo.srcObject = mediaStream;
              // tracks.forEach(track => peerConnection.addTrack(track, mediaStream));

              disconnect = function disconnect() {
                socket.close();
                tracks.forEach(function (track) {
                  return track.stop();
                });
                peerConnection.close();
              };

            case 8:
            case "end":
              return _context4.stop();
          }
        }
      }, _callee4);
    }));
    return _p2pConnect.apply(this, arguments);
  }

  function createConnectP2P() {
    var peerConnection = new RTCPeerConnection({
      iceServers: iceServers,
      iceTransportPolicy: 'relay'
    });
    var dataChanel = peerConnection.createDataChannel('testChanel');
    peerListen(peerConnection, dataChanel, remoteVideo);
    return peerConnection;
  }

  function peerListen(peerConnection, dataChanel, elRemoteVideo) {
    dataChanel.addEventListener('open', function (e) {
      console.dir('Канал p2p открыт');
    });
    dataChanel.addEventListener('close', function (e) {
      console.dir('Канал p2p закрыт');
    });
    dataChanel.addEventListener('message', function (e) {
      console.log('Message по p2p: ', e.data);
    });
    peerConnection.addEventListener('datachannel', function (e) {
      console.dir('Передача канала');
    });
    peerConnection.addEventListener('track', function (e) {
      console.log('Получение videoTrack', e);
      elRemoteVideo.srcObject = e.streams[0];
    });
    peerConnection.addEventListener('negotiationneeded', function (e) {
      console.log('Переговоры p2p', e);
    });
  }
  /*------------------------------------------------------------------------------------------------------------------------------------------*/


  function createWebSocketConnect(peerConnection) {
    var socket = new WebSocket("ws://localhost:4000");
    var clientId = uuid4(); // caller - вызывающий, callee - вызываемый

    var sendWS = function sendWS(payload) {
      socket.send(JSON.stringify(payload));
    };

    function toggleChanel(e) {
      sendWS({
        type: 'updateChanel',
        clientId: clientId,
        room: selectChanel.value
      });
    }

    socket.addEventListener('close', function (e) {
      console.log('Соединение с сервером WS разорвано');
      selectChanel.removeEventListener('change', toggleChanel);
    }); //

    socket.addEventListener('error', function (e) {
      console.log('Ошибка соединения с сервером WS разорвано');
    });
    socket.addEventListener('error', function (e) {
      console.log('Ошибка соединения с сервером WS разорвано');
    });
    socket.addEventListener('open', function (e) {
      console.log('Соединение с сервером WS установленно');
      console.log(clientId, 'clientId');
      sendWS({
        type: 'peer',
        clientId: clientId,
        room: selectChanel.value
      });
      createWebSocketConnectTest(peerConnection, socket, sendWS);
      selectChanel.addEventListener('change', toggleChanel);
    });
    return socket;
  }

  function createWebSocketConnectTest(peerConnection, socket, sendWS) {
    peerConnection.onnegotiationneeded = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {
      return regeneratorRuntime.wrap(function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              _context.prev = 0;
              _context.t0 = peerConnection;
              _context.next = 4;
              return peerConnection.createOffer();

            case 4:
              _context.t1 = _context.sent;
              _context.next = 7;
              return _context.t0.setLocalDescription.call(_context.t0, _context.t1);

            case 7:
              console.dir(peerConnection.localDescription);
              sendWS({
                desc: peerConnection.localDescription
              });
              _context.next = 14;
              break;

            case 11:
              _context.prev = 11;
              _context.t2 = _context["catch"](0);
              console.error(_context.t2);

            case 14:
            case "end":
              return _context.stop();
          }
        }
      }, _callee, null, [[0, 11]]);
    }));

    peerConnection.onicecandidate = function (_ref2) {
      var candidate = _ref2.candidate;
      return sendWS({
        candidate: candidate
      });
    };

    peerConnection.ontrack = function (event) {
      !remoteView.srcObject && (remoteView.srcObject = event.streams[0]);
    };

    socket.onmessage = /*#__PURE__*/function () {
      var _ref4 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(_ref3) {
        var desc, candidate, stream;
        return regeneratorRuntime.wrap(function _callee2$(_context2) {
          while (1) {
            switch (_context2.prev = _context2.next) {
              case 0:
                desc = _ref3.desc, candidate = _ref3.candidate;
                _context2.prev = 1;

                if (!desc) {
                  _context2.next = 20;
                  break;
                }

                _context2.t0 = desc.type;
                _context2.next = _context2.t0 === 'offer' ? 6 : _context2.t0 === 'answer' ? 12 : 15;
                break;

              case 6:
                _context2.next = 8;
                return navigator.mediaDevices.getUserMedia({
                  video: true,
                  audio: true
                });

              case 8:
                stream = _context2.sent;
                stream.getTracks().forEach(function (track) {
                  return peerConnection.addTrack(track, stream);
                });
                createOffer();
                return _context2.abrupt("break", 20);

              case 12:
                _context2.next = 14;
                return peerConnection.setRemoteDescription(desc);

              case 14:
                return _context2.abrupt("break", 20);

              case 15:
                _context2.t1 = candidate;

                if (!_context2.t1) {
                  _context2.next = 19;
                  break;
                }

                _context2.next = 19;
                return pc.addIceCandidate(candidate);

              case 19:
                return _context2.abrupt("break", 20);

              case 20:
                _context2.next = 25;
                break;

              case 22:
                _context2.prev = 22;
                _context2.t2 = _context2["catch"](1);
                console.error(_context2.t2);

              case 25:
              case "end":
                return _context2.stop();
            }
          }
        }, _callee2, null, [[1, 22]]);
      }));

      return function (_x) {
        return _ref4.apply(this, arguments);
      };
    }();

    var createOffer = /*#__PURE__*/function () {
      var _ref5 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(pc, sendWS, desc) {
        return regeneratorRuntime.wrap(function _callee3$(_context3) {
          while (1) {
            switch (_context3.prev = _context3.next) {
              case 0:
                _context3.next = 2;
                return pc.setRemoteDescription(desc);

              case 2:
                _context3.t0 = pc;
                _context3.next = 5;
                return pc.createAnswer();

              case 5:
                _context3.t1 = _context3.sent;
                _context3.next = 8;
                return _context3.t0.setLocalDescription.call(_context3.t0, _context3.t1);

              case 8:
                sendWS({
                  desc: pc.localDescription
                });

              case 9:
              case "end":
                return _context3.stop();
            }
          }
        }, _callee3);
      }));

      return function createOffer(_x2, _x3, _x4) {
        return _ref5.apply(this, arguments);
      };
    }();
  }
});
/*------------------------------------------------------------------------------------------------------------------------------------------ */

/*
  Blob можно превратить в URL такого вида:
  blob:http://127.0.0.1:5500/ac67d59c-3e02-4cb2-a0df-33a53afeeb2c

  Способ сделать фото с камеры:
      let capture = new ImageCapture(videoTrack);
      capture.takePhoto().then(async (blob)=>{
        let objectURL = URL.createObjectURL(blob);
        console.dir(objectURL);
        elImg.setAttribute('src', objectURL)
      })
*/

/*#########--------<{ WebSocked }>------####### 
extensions: ""
onclose: null
onerror: null
onmessage: null
onopen: null//отрабатывает если есть подключение к ws серверу
//методы
send
close
*/
// function createWebSocketConnect(peerConnection){
//   let socket = new WebSocket("ws://localhost:4000");
//   socket.addEventListener('close', (e) => { console.log('Соединение с сервером WS разорвано'); });
//   socket.addEventListener('error', (e) => { console.log('Ошибка соединения с сервером WS разорвано'); });
//   socket.addEventListener('open',  (e) => {
//     console.log('Соединение с сервером WS установленно'); 
//     let clientId = uuid4();     // caller - вызывающий, callee - вызываемый
//     console.log(clientId, 'clientId');
//     const sendWS = (payload) => { socket.send(JSON.stringify(payload)) }
//     sendWS({ type: 'peer', clientId, room: '' });
//     peerConnection.addEventListener('icecandidate', (e) => {
//       (e.candidate) && sendWS({ type: 'candidate', candidate: e.candidate });
//     })
//     socket.addEventListener('message', async ({data, ...e}) => {
//       data = JSON.parse(data);
//       switch (data.type) {
//         case 'peer': (data.clientId !== clientId) && sendWS({type: 'initID', caller: clientId, callee: data.clientId }); break;
//         case 'initID': (data.caller === clientId) && createOffer(peerConnection, sendWS, data); break;          
//         case 'candidate': peerConnection.addIceCandidate(data.candidate); break;      
//         case 'offer': (data.callee === clientId) && createAnswer(peerConnection, sendWS, data); break;
//         case 'answer': (data.caller === clientId) && peerConnection.setRemoteDescription(data); break;
//         default: break;
//       }
//     })
//   })
// }

function uuid4() {
  function hex(s, b) {
    return s + (b >>> 4).toString(16) + // high nibble
    (b & 15).toString(16); // low nibble
  }

  var r = crypto.getRandomValues(new Uint8Array(16));
  r[6] = r[6] >>> 4 | 64; // Set type 4: 0100

  r[8] = r[8] >>> 3 | 128; // Set variant: 100

  return r.slice(0, 4).reduce(hex, '') + r.slice(4, 6).reduce(hex, '-') + r.slice(6, 8).reduce(hex, '-') + r.slice(8, 10).reduce(hex, '-') + r.slice(10, 16).reduce(hex, '-');
}

},{}]},{},[1,2])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvYXNzZXRzL2pzL2Rldi9pbmRleC5qcyIsInNyYy9hc3NldHMvanMvZGV2L2luZGV4Mi5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Ozs7Ozs7QUNBQSxnQkFBZ0IsQ0FBQyxrQkFBRCxFQUFxQixZQUFNO0FBRXpDLE1BQUksVUFBVSxHQUFHLFFBQVEsQ0FBQyxjQUFULENBQXdCLGFBQXhCLENBQWpCO0FBQ0EsTUFBSSxXQUFXLEdBQUcsUUFBUSxDQUFDLGNBQVQsQ0FBd0IsY0FBeEIsQ0FBbEI7QUFDQSxNQUFJLFFBQVEsR0FBRyxRQUFRLENBQUMsY0FBVCxDQUF3QixpQkFBeEIsQ0FBZjtBQUNBLE1BQUksT0FBTyxHQUFHLFFBQVEsQ0FBQyxjQUFULENBQXdCLGdCQUF4QixDQUFkO0FBQ0EsTUFBSSxVQUFVLEdBQUcsUUFBUSxDQUFDLGNBQVQsQ0FBd0IsZ0JBQXhCLENBQWpCLENBTnlDLENBUTNDOztBQUNFLE1BQUksV0FBVyxHQUFHO0FBQ2hCLElBQUEsS0FBSyxFQUFFO0FBQUMsTUFBQSxRQUFRLEVBQUMsQ0FBQztBQUFDLFFBQUEsTUFBTSxFQUFFO0FBQVQsT0FBRCxDQUFWO0FBQTJCLE1BQUEsTUFBTSxFQUFFLEdBQW5DO0FBQXdDLE1BQUEsS0FBSyxFQUFFO0FBQS9DLEtBRFM7QUFFaEIsSUFBQSxLQUFLLEVBQUU7QUFGUyxHQUFsQjtBQUtBLE1BQUksVUFBVSxHQUFHLENBQUM7QUFDZCxJQUFBLElBQUksRUFBRSxzQ0FEUTtBQUVkLElBQUEsUUFBUSxFQUFFLFVBRkk7QUFHZCxJQUFBLFVBQVUsRUFBRSxZQUhFO0FBSWQsSUFBQSxjQUFjLEVBQUU7QUFKRixHQUFELEVBTWY7QUFBRSxJQUFBLElBQUksRUFBRTtBQUFSLEdBTmUsRUFPZjtBQUNFLElBQUEsSUFBSSxFQUFFLHdCQURSO0FBRUUsSUFBQSxRQUFRLEVBQUUsVUFGWjtBQUdFLElB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QVQsQ0FBYSxDQUFiLEVBQWdCLENBQWhCLEVBQW1CO0FBQ2YsV0FBTyxDQUFDLEdBQ0osQ0FBQyxDQUFDLEtBQUssQ0FBUCxFQUFVLFFBQVYsQ0FBbUIsRUFBbkIsQ0FERyxHQUNzQjtBQUN6QixLQUFDLENBQUMsR0FBRyxFQUFMLEVBQWEsUUFBYixDQUFzQixFQUF0QixDQUZKLENBRGUsQ0FHZ0I7QUFDbEM7O0FBRUQsTUFBSSxDQUFDLEdBQUcsTUFBTSxDQUFDLGVBQVAsQ0FBdUIsSUFBSSxVQUFKLENBQWUsRUFBZixDQUF2QixDQUFSO0FBRUEsRUFBQSxDQUFDLENBQUMsQ0FBRCxDQUFELEdBQU8sQ0FBQyxDQUFDLENBQUQsQ0FBRCxLQUFTLENBQVQsR0FBYSxFQUFwQixDQVRlLENBU2lCOztBQUNoQyxFQUFBLENBQUMsQ0FBQyxDQUFELENBQUQsR0FBTyxDQUFDLENBQUMsQ0FBRCxDQUFELEtBQVMsQ0FBVCxHQUFhLEdBQXBCLENBVmUsQ0FVaUI7O0FBRWhDLFNBQU8sQ0FBQyxDQUFDLEtBQUYsQ0FBUSxDQUFSLEVBQVcsQ0FBWCxFQUFjLE1BQWQsQ0FBcUIsR0FBckIsRUFBMEIsRUFBMUIsSUFDSCxDQUFDLENBQUMsS0FBRixDQUFRLENBQVIsRUFBVyxDQUFYLEVBQWMsTUFBZCxDQUFxQixHQUFyQixFQUEwQixHQUExQixDQURHLEdBRUgsQ0FBQyxDQUFDLEtBQUYsQ0FBUSxDQUFSLEVBQVcsQ0FBWCxFQUFjLE1BQWQsQ0FBcUIsR0FBckIsRUFBMEIsR0FBMUIsQ0FGRyxHQUdILENBQUMsQ0FBQyxLQUFGLENBQVEsQ0FBUixFQUFXLEVBQVgsRUFBZSxNQUFmLENBQXNCLEdBQXRCLEVBQTJCLEdBQTNCLENBSEcsR0FJSCxDQUFDLENBQUMsS0FBRixDQUFRLEVBQVIsRUFBWSxFQUFaLEVBQWdCLE1BQWhCLENBQXVCLEdBQXZCLEVBQTRCLEdBQTVCLENBSko7QUFLRCIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsImFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoKSA9PiB7XHJcblxyXG4gIGxldCBsb2NhbFZpZGVvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvY2FsV2ViUlRDJyk7XHJcbiAgbGV0IHJlbW90ZVZpZGVvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlbW90ZVdlYlJUQycpO1xyXG4gIGxldCBidG5TdGFydCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYnRuLXZpZGVvLXN0YXJ0XCIpO1xyXG4gIGxldCBidG5TdG9wID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJidG4tdmlkZW8tc3RvcFwiKTtcclxuICBsZXQgY2FsbEJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidG4tdmlkZW8tY2FsbCcpXHJcblxyXG4vL9Cy0L7Qt9C80L7QttC90YvQtSDQvtCz0YDQsNC90LjRh9C10L3QuNGPXHJcbiAgbGV0IGNvbnN0cmFpbnRzID0ge1xyXG4gICAgdmlkZW86IHthZHZhbmNlZDpbe2hlaWdodDogMTUwfV0sIGhlaWdodDogMzAwLCB3aWR0aDogMzAwfSxcclxuICAgIGF1ZGlvOiB0cnVlXHJcbiAgfTtcclxuXHJcbiAgbGV0IGljZVNlcnZlcnMgPSBbe1xyXG4gICAgICB1cmxzOiBcInR1cm46Ym90LnJ1aXRiLnJ1OjUzNDk/dHJhbnNwb3J0PXRjcFwiLFxyXG4gICAgICB1c2VybmFtZTogXCJ0ZWxlbWVkMVwiLFxyXG4gICAgICBjcmVkZW50aWFsOiBcIkxvbXdlNjc1RGZcIixcclxuICAgICAgY3JlZGVudGlhbFR5cGU6IFwicGFzc3dvcmRcIlxyXG4gICAgfSxcclxuICAgIHsgdXJsczogXCJzdHVuOnN0dW4uc3R1bnByb3RvY29sLm9yZ1wiIH0sXHJcbiAgICB7XHJcbiAgICAgIHVybHM6IFwidHVybjpib3QucnVpdGIucnU6NTM0OVwiLFxyXG4gICAgICB1c2VybmFtZTogXCJ0ZWxlbWVkMVwiLFxyXG4gICAgICBjcmVkZW50aWFsOiBcIkxvbXdlNjc1RGZcIixcclxuICAgICAgY3JlZGVudGlhbFR5cGU6IFwicGFzc3dvcmRcIixcclxuICAgIH0se1xyXG4gICAgICB1cmxzOiBcInR1cm46Ym90LnJ1aXRiLnJ1OjM0NzhcIixcclxuICAgICAgdXNlcm5hbWU6IFwidGVsZW1lZDFcIixcclxuICAgICAgY3JlZGVudGlhbDogXCJMb213ZTY3NURmXCIsXHJcbiAgICAgIGNyZWRlbnRpYWxUeXBlOiBcInBhc3N3b3JkXCIsXHJcbiAgICB9LHtcclxuICAgICAgdXJsczogXCJzdHVuOmJvdC5ydWl0Yi5ydTozNDc4XCIsXHJcbiAgICAgIHVzZXJuYW1lOiBcInRlbGVtZWQxXCIsXHJcbiAgICAgIGNyZWRlbnRpYWw6IFwiTG9td2U2NzVEZlwiLFxyXG4gICAgICBjcmVkZW50aWFsVHlwZTogXCJwYXNzd29yZFwiLFxyXG4gICAgfVxyXG4gIF07XHJcblxyXG4gIGxldCB2aWRlb0Nsb3NlO1xyXG4gIGJ0blN0YXJ0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB2aWRlb1N0YXJ0LCBmYWxzZSk7XHJcbiAgYnRuU3RvcC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT57ICh0eXBlb2YgdmlkZW9DbG9zZSA9PT0gJ2Z1bmN0aW9uJykgJiYgdmlkZW9DbG9zZSgpOyB9KVxyXG5cclxuLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xyXG4vKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXHJcbiAgXHJcbiAgYXN5bmMgZnVuY3Rpb24gdmlkZW9TdGFydCgpIHtcclxuXHJcbiAgICBsZXQgbWVkaWFTdHJlYW0gPSBhd2FpdCBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYSh7dmlkZW86IHticmlnaHRuZXNzOiAyMDAsaGVpZ2h0OiA1MDB9LCBhdWRpbzogdHJ1ZX0pO1xyXG4gXHJcbiAgICBsZXQgdmlkZW9UcmFja3MgPSBtZWRpYVN0cmVhbS5nZXRWaWRlb1RyYWNrcygpWzBdO1xyXG4gICAgdmlkZW9DbG9zZSA9IGZ1bmN0aW9uKCl7IHZpZGVvVHJhY2tzLnN0b3AoKTsgfVxyXG5cclxuXHJcbiAgIFxyXG4gICAgbGV0IGF1ZGlvQ29udGV4dCA9IHVzZUF1ZGlvQ29udGV4dChtZWRpYVN0cmVhbSk7XHJcblxyXG4gICAgbG9jYWxWaWRlby5zcmNPYmplY3QgPSBtZWRpYVN0cmVhbTtcclxuXHJcbiAgIFxyXG4gICAgY3JlYXRlQ29ubmVjdFAyUChtZWRpYVN0cmVhbSk7XHJcbiAgfVxyXG5cclxuXHJcbiAgZnVuY3Rpb24gY3JlYXRlQ29ubmVjdFAyUChtZWRpYVN0cmVhbSkge1xyXG5cclxuICAgIGxldCBwZWVyQ29ubmVjdGlvbiA9IG5ldyBSVENQZWVyQ29ubmVjdGlvbih7IGljZVNlcnZlcnMsIGljZVRyYW5zcG9ydFBvbGljeTogJ3JlbGF5J30pO1xyXG4gICAgbGV0IGRhdGFDaGFuZWwgPSBwZWVyQ29ubmVjdGlvbi5jcmVhdGVEYXRhQ2hhbm5lbCgndGVzdENoYW5lbCcpO1xyXG4gICBcclxuICAgIG1lZGlhU3RyZWFtLmdldFRyYWNrcygpLmZvckVhY2godHJhY2sgPT4gcGVlckNvbm5lY3Rpb24uYWRkVHJhY2sodHJhY2ssIG1lZGlhU3RyZWFtKSk7XHJcbiAgICBcclxuICAgIC8qIyMjIyMjIyMjLS0tLS0tLS0tLTx7IEV2ZW50IENoYW5lbCB9Pi0tLS0tLS0tLSMjIyMjIyMjIyMjKi9cclxuICAgIC8v0J7RgtC60YDRi9Cy0LDQtdGC0YHRjyDRgdC+0LXQtNC40L3QtdC90LjQtSDQv9C+0YHQu9C1INC+0LHQvNC10L3QsCBvZmZlciwgYW5zd2VyICBcclxuICAgIFxyXG4gICAgZGF0YUNoYW5lbC5hZGRFdmVudExpc3RlbmVyKCdvcGVuJywgKGUpID0+IHtcclxuICAgICAgY29uc29sZS5kaXIoJ9Ca0LDQvdCw0Lsg0L7RgtC60YDRi9GCJyk7XHJcbiAgICAgXHJcbiAgICB9KTtcclxuXHJcbiAgICBkYXRhQ2hhbmVsLmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCAoZSkgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZygnTWVzc2FnZTogJywgZS5kYXRhKTtcclxuICAgIH0pO1xyXG5cclxuXHJcbiAgICBwZWVyQ29ubmVjdGlvbi5hZGRFdmVudExpc3RlbmVyKCdkYXRhY2hhbm5lbCcsIChlKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZGlyKCfQn9C10YDQtdC00LDRh9CwINC60LDQvdCw0LvQsCcpO1xyXG4gICAgfSlcclxuICAgIFxyXG4gICAgcGVlckNvbm5lY3Rpb24uYWRkRXZlbnRMaXN0ZW5lcigndHJhY2snLCAoZSkgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZygn0J/QvtC70YPRh9C10L3QuNC1IHRyYWNrJywgZSk7XHJcblxyXG4gICAgICByZW1vdGVWaWRlby5zcmNPYmplY3QgPSBlLnN0cmVhbXNbMF07XHJcbiAgICB9KVxyXG4gICAgXHJcbiAgICAvKiMjIyMjIyMjIy0tLS0tLS0tLS08eyBFdmVudCBwZWVyQ29ubmVjdGlvbiB9Pi0tLS0tLS0tLSMjIyMjIyMjIyMjXHJcbiAgICAgIGljZWNhbmRpZGF0ZSAtINC+0YLRgNCw0LHQsNGC0YvQstCw0LXRgiDQtdGB0LvQuCDQstGL0LfQstCw0LvQuCBjcmVhdGVPZmZlciDQuCDQv9C10YDQtdC00LDQu9C4INC00LDQvdC90YvQtSDQsiBcclxuICAgICAgICAgICAgICAgICAgICAgcGVlckNvbm5lY3Rpb24uc2V0TG9jYWxEZXNjcmlwdGlvbihvZmZlck1ldGFEYXRhKVxyXG4gICAgKi9cclxuXHJcbiAgICBcclxuICAgIHBlZXJDb25uZWN0aW9uLmFkZEV2ZW50TGlzdGVuZXIoJ25lZ290aWF0aW9ubmVlZGVkJywgKGUpID0+IHtcclxuICAgICAgY29uc29sZS5kaXIoZSk7XHJcbiAgICB9KSAgICAgXHJcblxyXG4gICAgY3JlYXRlV2ViU29ja2V0Q29ubmVjdChwZWVyQ29ubmVjdGlvbik7XHJcbiAgfVxyXG5cclxuLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xyXG5cclxuICBmdW5jdGlvbiBjcmVhdGVXZWJTb2NrZXRDb25uZWN0KHBlZXJDb25uZWN0aW9uKXtcclxuXHJcbiAgICBsZXQgc29ja2V0ID0gbmV3IFdlYlNvY2tldChcIndzOi8vbG9jYWxob3N0OjQwMDBcIik7XHJcbiAgICBzb2NrZXQuYWRkRXZlbnRMaXN0ZW5lcignY2xvc2UnLCAoZSkgPT4geyBjb25zb2xlLmxvZygn0KHQvtC10LTQuNC90LXQvdC40LUg0YEg0YHQtdGA0LLQtdGA0L7QvCBXUyDRgNCw0LfQvtGA0LLQsNC90L4nKTsgfSk7XHJcbiAgICBzb2NrZXQuYWRkRXZlbnRMaXN0ZW5lcignZXJyb3InLCAoZSkgPT4geyBjb25zb2xlLmxvZygn0J7RiNC40LHQutCwINGB0L7QtdC00LjQvdC10L3QuNGPINGBINGB0LXRgNCy0LXRgNC+0LwgV1Mg0YDQsNC30L7RgNCy0LDQvdC+Jyk7IH0pO1xyXG4gICAgc29ja2V0LmFkZEV2ZW50TGlzdGVuZXIoJ29wZW4nLCAgKGUpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coJ9Ch0L7QtdC00LjQvdC10L3QuNC1INGBINGB0LXRgNCy0LXRgNC+0LwgV1Mg0YPRgdGC0LDQvdC+0LLQu9C10L3QvdC+Jyk7IFxyXG4gICAgICBsZXQgY2xpZW50SWQgPSB1dWlkNCgpOyAgICAgLy8gY2FsbGVyIC0g0LLRi9C30YvQstCw0Y7RidC40LksIGNhbGxlZSAtINCy0YvQt9GL0LLQsNC10LzRi9C5XHJcbiAgIFxyXG4gICAgICBjb25zb2xlLmxvZyhjbGllbnRJZCwgJ2NsaWVudElkJyk7XHJcbiAgICAgIGNvbnN0IHNlbmRXUyA9IChwYXlsb2FkKSA9PiB7IHNvY2tldC5zZW5kKEpTT04uc3RyaW5naWZ5KHBheWxvYWQpKSB9XHJcbiAgICAgIHNlbmRXUyh7IHR5cGU6ICdwZWVyJywgY2xpZW50SWQsIHJvb206ICcnIH0pO1xyXG5cclxuXHJcblxyXG4gICAgICBwZWVyQ29ubmVjdGlvbi5hZGRFdmVudExpc3RlbmVyKCdpY2VjYW5kaWRhdGUnLCAoZSkgPT4ge1xyXG4gICAgICAgIChlLmNhbmRpZGF0ZSkgJiYgc2VuZFdTKHsgdHlwZTogJ2NhbmRpZGF0ZScsIGNhbmRpZGF0ZTogZS5jYW5kaWRhdGUgfSk7XHJcbiAgICAgIH0pXHJcblxyXG5cclxuICAgICAgc29ja2V0LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBhc3luYyAoe2RhdGEsIC4uLmV9KSA9PiB7XHJcbiAgICAgICAgZGF0YSA9IEpTT04ucGFyc2UoZGF0YSk7XHJcblxyXG4gICAgICAgIHN3aXRjaCAoZGF0YS50eXBlKSB7XHJcbiAgICAgICAgICBjYXNlICdwZWVyJzogKGRhdGEuY2xpZW50SWQgIT09IGNsaWVudElkKSAmJiBzZW5kV1Moe3R5cGU6ICdpbml0SUQnLCBjYWxsZXI6IGNsaWVudElkLCBjYWxsZWU6IGRhdGEuY2xpZW50SWQgfSk7IGJyZWFrO1xyXG4gICAgICAgICAgY2FzZSAnaW5pdElEJzogKGRhdGEuY2FsbGVyID09PSBjbGllbnRJZCkgJiYgY3JlYXRlT2ZmZXIocGVlckNvbm5lY3Rpb24sIHNlbmRXUywgZGF0YSk7IGJyZWFrOyAgICAgICAgICBcclxuICAgICAgICAgIGNhc2UgJ2NhbmRpZGF0ZSc6IHBlZXJDb25uZWN0aW9uLmFkZEljZUNhbmRpZGF0ZShkYXRhLmNhbmRpZGF0ZSk7IGJyZWFrOyAgICAgIFxyXG4gICAgICAgICAgY2FzZSAnb2ZmZXInOiAoZGF0YS5jYWxsZWUgPT09IGNsaWVudElkKSAmJiBjcmVhdGVBbnN3ZXIocGVlckNvbm5lY3Rpb24sIHNlbmRXUywgZGF0YSk7IGJyZWFrO1xyXG4gICAgICAgICAgY2FzZSAnYW5zd2VyJzogKGRhdGEuY2FsbGVyID09PSBjbGllbnRJZCkgJiYgcGVlckNvbm5lY3Rpb24uc2V0UmVtb3RlRGVzY3JpcHRpb24oZGF0YSk7IGJyZWFrO1xyXG4gICAgICAgICAgZGVmYXVsdDogYnJlYWs7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgfSlcclxuXHJcbiAgICB9KVxyXG5cclxuICB9XHJcblxyXG5cclxuXHJcblxyXG5cclxuLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXHJcblxyXG5cclxuXHJcbiAgY29uc3QgY3JlYXRlT2ZmZXIgPSBhc3luYyAocGVlckMsIHNlbmRXUywgeyBjYWxsZXIsIGNhbGxlZSB9KSA9PiB7XHJcbiAgICBwZWVyQy5jbGllbnRJRCA9IHsgY2FsbGVyLCBjYWxsZWUgfTtcclxuICAgIGxldCB7IHR5cGUsIHNkcCB9ID0gYXdhaXQgcGVlckMuY3JlYXRlT2ZmZXIoeyBvZmZlclRvUmVjZWl2ZUF1ZGlvOiB0cnVlLCBvZmZlclRvUmVjZWl2ZVZpZGVvOiB0cnVlIH0pO1xyXG5cclxuICAgIGF3YWl0IHBlZXJDLnNldExvY2FsRGVzY3JpcHRpb24oeyB0eXBlLCBzZHAgfSkgXHJcbiAgICBzZW5kV1MoeyB0eXBlLCBzZHAsIGNhbGxlciwgY2FsbGVlIH0pO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgY3JlYXRlQW5zd2VyID0gYXN5bmMgKHBlZXJDLCBzZW5kV1MsIHsgY2FsbGVyLCBjYWxsZWUsIC4uLmRhdGFQZWVyIH0pID0+IHtcclxuICAgIHBlZXJDLmNsaWVudElEID0geyBjYWxsZXIsIGNhbGxlZSB9O1xyXG4gICAgYXdhaXQgcGVlckMuc2V0UmVtb3RlRGVzY3JpcHRpb24oZGF0YVBlZXIpO1xyXG4gICAgbGV0IHsgdHlwZSwgc2RwIH0gPSBhd2FpdCBwZWVyQy5jcmVhdGVBbnN3ZXIoKTtcclxuICAgIGF3YWl0IHBlZXJDLnNldExvY2FsRGVzY3JpcHRpb24oeyB0eXBlLCBzZHAgfSkgXHJcbiAgICBzZW5kV1MoeyB0eXBlLCBzZHAsIGNhbGxlciwgY2FsbGVlIH0pO1xyXG4gIH1cclxuXHJcbiBcclxufSlcclxuXHJcblxyXG5cclxuLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuXHJcbmxldCBvcHRpb25zQXVkaW8gPSB7XHJcbiAgZmlsdGVyOiB7XHJcbiAgICB0eXBlOiAnaGlnaHBhc3MnLFxyXG4gICAgZnJlcXVlbmN5OiAxMDAwMFxyXG4gIH0sXHJcbiAgZ2Fpbjoge1xyXG4gICAgdmFsdWU6IDAuNVxyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gdXNlQXVkaW9Db250ZXh0KG1lZGlhU3RyZWFtLCBvcHRpb25zID0gb3B0aW9uc0F1ZGlvKXtcclxuIFxyXG4gIGxldCB7IGZpbHRlciwgZ2FpbiB9ID0gb3B0aW9ucztcclxuICBsZXQgYXVkaW9Db250ZXh0ID0gbmV3IEF1ZGlvQ29udGV4dCgpO1xyXG4gIFxyXG4gIGxldCBhdWRpb1N0cmVhbSA9IGF1ZGlvQ29udGV4dC5jcmVhdGVNZWRpYVN0cmVhbVNvdXJjZShtZWRpYVN0cmVhbSk7XHJcbiAgXHJcbiAgbGV0IGF1ZGlvRmlsdGVyID0gYXVkaW9Db250ZXh0LmNyZWF0ZUJpcXVhZEZpbHRlcigpO1xyXG4gIGF1ZGlvRmlsdGVyLnR5cGUgPSBmaWx0ZXIudHlwZTtcclxuICBhdWRpb0ZpbHRlci5mcmVxdWVuY3kudmFsdWUgPSBmaWx0ZXIuZnJlcXVlbmN5O1xyXG5cclxuICBsZXQgYXVkaW9HYWluID0gYXVkaW9Db250ZXh0LmNyZWF0ZUdhaW4oKTtcclxuICBhdWRpb0dhaW4uZ2Fpbi52YWx1ZSA9IGdhaW4udmFsdWU7XHJcblxyXG4gIGF1ZGlvU3RyZWFtLmNvbm5lY3QoYXVkaW9GaWx0ZXIuY29ubmVjdChhdWRpb0dhaW4pKTtcclxuXHJcblxyXG4gIHJldHVybiBhdWRpb0NvbnRleHQ7IFxyXG59XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbi8qXHJcbiAgQmxvYiDQvNC+0LbQvdC+INC/0YDQtdCy0YDQsNGC0LjRgtGMINCyIFVSTCDRgtCw0LrQvtCz0L4g0LLQuNC00LA6XHJcbiAgYmxvYjpodHRwOi8vMTI3LjAuMC4xOjU1MDAvYWM2N2Q1OWMtM2UwMi00Y2IyLWEwZGYtMzNhNTNhZmVlYjJjXHJcblxyXG4gINCh0L/QvtGB0L7QsSDRgdC00LXQu9Cw0YLRjCDRhNC+0YLQviDRgSDQutCw0LzQtdGA0Ys6XHJcbiAgICAgIGxldCBjYXB0dXJlID0gbmV3IEltYWdlQ2FwdHVyZSh2aWRlb1RyYWNrKTtcclxuICAgICAgY2FwdHVyZS50YWtlUGhvdG8oKS50aGVuKGFzeW5jIChibG9iKT0+e1xyXG4gICAgICAgIGxldCBvYmplY3RVUkwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpO1xyXG4gICAgICAgIGNvbnNvbGUuZGlyKG9iamVjdFVSTCk7XHJcbiAgICAgICAgZWxJbWcuc2V0QXR0cmlidXRlKCdzcmMnLCBvYmplY3RVUkwpXHJcbiAgICAgIH0pXHJcbiovXHJcblxyXG5cclxuXHJcblxyXG5cclxuLyojIyMjIyMjIyMtLS0tLS0tLTx7IFdlYlNvY2tlZCB9Pi0tLS0tLSMjIyMjIyMgXHJcbmV4dGVuc2lvbnM6IFwiXCJcclxub25jbG9zZTogbnVsbFxyXG5vbmVycm9yOiBudWxsXHJcbm9ubWVzc2FnZTogbnVsbFxyXG5vbm9wZW46IG51bGwvL9C+0YLRgNCw0LHQsNGC0YvQstCw0LXRgiDQtdGB0LvQuCDQtdGB0YLRjCDQv9C+0LTQutC70Y7Rh9C10L3QuNC1INC6IHdzINGB0LXRgNCy0LXRgNGDXHJcbi8v0LzQtdGC0L7QtNGLXHJcbnNlbmRcclxuY2xvc2VcclxuKi9cclxuXHJcblxyXG5cclxuXHJcblxyXG4vLyBmdW5jdGlvbiBjcmVhdGVXZWJTb2NrZXRDb25uZWN0KHBlZXJDb25uZWN0aW9uKXtcclxuXHJcbi8vICAgbGV0IHNvY2tldCA9IG5ldyBXZWJTb2NrZXQoXCJ3czovL2xvY2FsaG9zdDo0MDAwXCIpO1xyXG4vLyAgIHNvY2tldC5hZGRFdmVudExpc3RlbmVyKCdjbG9zZScsIChlKSA9PiB7IGNvbnNvbGUubG9nKCfQodC+0LXQtNC40L3QtdC90LjQtSDRgSDRgdC10YDQstC10YDQvtC8IFdTINGA0LDQt9C+0YDQstCw0L3QvicpOyB9KTtcclxuLy8gICBzb2NrZXQuYWRkRXZlbnRMaXN0ZW5lcignZXJyb3InLCAoZSkgPT4geyBjb25zb2xlLmxvZygn0J7RiNC40LHQutCwINGB0L7QtdC00LjQvdC10L3QuNGPINGBINGB0LXRgNCy0LXRgNC+0LwgV1Mg0YDQsNC30L7RgNCy0LDQvdC+Jyk7IH0pO1xyXG4vLyAgIHNvY2tldC5hZGRFdmVudExpc3RlbmVyKCdvcGVuJywgIChlKSA9PiB7XHJcbi8vICAgICBjb25zb2xlLmxvZygn0KHQvtC10LTQuNC90LXQvdC40LUg0YEg0YHQtdGA0LLQtdGA0L7QvCBXUyDRg9GB0YLQsNC90L7QstC70LXQvdC90L4nKTsgXHJcbi8vICAgICBsZXQgY2xpZW50SWQgPSB1dWlkNCgpOyAgICAgLy8gY2FsbGVyIC0g0LLRi9C30YvQstCw0Y7RidC40LksIGNhbGxlZSAtINCy0YvQt9GL0LLQsNC10LzRi9C5XHJcbiBcclxuLy8gICAgIGNvbnNvbGUubG9nKGNsaWVudElkLCAnY2xpZW50SWQnKTtcclxuLy8gICAgIGNvbnN0IHNlbmRXUyA9IChwYXlsb2FkKSA9PiB7IHNvY2tldC5zZW5kKEpTT04uc3RyaW5naWZ5KHBheWxvYWQpKSB9XHJcbi8vICAgICBzZW5kV1MoeyB0eXBlOiAncGVlcicsIGNsaWVudElkLCByb29tOiAnJyB9KTtcclxuXHJcbi8vICAgICBwZWVyQ29ubmVjdGlvbi5hZGRFdmVudExpc3RlbmVyKCdpY2VjYW5kaWRhdGUnLCAoZSkgPT4ge1xyXG4vLyAgICAgICAoZS5jYW5kaWRhdGUpICYmIHNlbmRXUyh7IHR5cGU6ICdjYW5kaWRhdGUnLCBjYW5kaWRhdGU6IGUuY2FuZGlkYXRlIH0pO1xyXG4vLyAgICAgfSlcclxuXHJcblxyXG4vLyAgICAgc29ja2V0LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBhc3luYyAoe2RhdGEsIC4uLmV9KSA9PiB7XHJcbi8vICAgICAgIGRhdGEgPSBKU09OLnBhcnNlKGRhdGEpO1xyXG5cclxuLy8gICAgICAgc3dpdGNoIChkYXRhLnR5cGUpIHtcclxuLy8gICAgICAgICBjYXNlICdwZWVyJzogKGRhdGEuY2xpZW50SWQgIT09IGNsaWVudElkKSAmJiBzZW5kV1Moe3R5cGU6ICdpbml0SUQnLCBjYWxsZXI6IGNsaWVudElkLCBjYWxsZWU6IGRhdGEuY2xpZW50SWQgfSk7IGJyZWFrO1xyXG4vLyAgICAgICAgIGNhc2UgJ2luaXRJRCc6IChkYXRhLmNhbGxlciA9PT0gY2xpZW50SWQpICYmIGNyZWF0ZU9mZmVyKHBlZXJDb25uZWN0aW9uLCBzZW5kV1MsIGRhdGEpOyBicmVhazsgICAgICAgICAgXHJcbi8vICAgICAgICAgY2FzZSAnY2FuZGlkYXRlJzogcGVlckNvbm5lY3Rpb24uYWRkSWNlQ2FuZGlkYXRlKGRhdGEuY2FuZGlkYXRlKTsgYnJlYWs7ICAgICAgXHJcbi8vICAgICAgICAgY2FzZSAnb2ZmZXInOiAoZGF0YS5jYWxsZWUgPT09IGNsaWVudElkKSAmJiBjcmVhdGVBbnN3ZXIocGVlckNvbm5lY3Rpb24sIHNlbmRXUywgZGF0YSk7IGJyZWFrO1xyXG4vLyAgICAgICAgIGNhc2UgJ2Fuc3dlcic6IChkYXRhLmNhbGxlciA9PT0gY2xpZW50SWQpICYmIHBlZXJDb25uZWN0aW9uLnNldFJlbW90ZURlc2NyaXB0aW9uKGRhdGEpOyBicmVhaztcclxuLy8gICAgICAgICBkZWZhdWx0OiBicmVhaztcclxuLy8gICAgICAgfVxyXG5cclxuLy8gICAgIH0pXHJcblxyXG4vLyAgIH0pXHJcblxyXG4vLyB9XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5mdW5jdGlvbiB1dWlkNCgpIHtcclxuICBmdW5jdGlvbiBoZXgocywgYikge1xyXG4gICAgICByZXR1cm4gcyArXHJcbiAgICAgICAgICAoYiA+Pj4gNCkudG9TdHJpbmcoMTYpICsgLy8gaGlnaCBuaWJibGVcclxuICAgICAgICAgIChiICYgMGIxMTExKS50b1N0cmluZygxNik7IC8vIGxvdyBuaWJibGVcclxuICB9XHJcblxyXG4gIHZhciByID0gY3J5cHRvLmdldFJhbmRvbVZhbHVlcyhuZXcgVWludDhBcnJheSgxNikpO1xyXG5cclxuICByWzZdID0gcls2XSA+Pj4gNCB8IDBiMDEwMDAwMDA7IC8vIFNldCB0eXBlIDQ6IDAxMDBcclxuICByWzhdID0gcls4XSA+Pj4gMyB8IDBiMTAwMDAwMDA7IC8vIFNldCB2YXJpYW50OiAxMDBcclxuXHJcbiAgcmV0dXJuIHIuc2xpY2UoMCwgNCkucmVkdWNlKGhleCwgJycpICtcclxuICAgICAgci5zbGljZSg0LCA2KS5yZWR1Y2UoaGV4LCAnLScpICtcclxuICAgICAgci5zbGljZSg2LCA4KS5yZWR1Y2UoaGV4LCAnLScpICtcclxuICAgICAgci5zbGljZSg4LCAxMCkucmVkdWNlKGhleCwgJy0nKSArXHJcbiAgICAgIHIuc2xpY2UoMTAsIDE2KS5yZWR1Y2UoaGV4LCAnLScpO1xyXG59IiwiYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsICgpID0+IHtcclxuXHJcbiAgbGV0IGxvY2FsVmlkZW8gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9jYWxXZWJSVEMnKTtcclxuICBsZXQgcmVtb3RlVmlkZW8gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVtb3RlV2ViUlRDJyk7XHJcbiAgbGV0IGJ0blN0YXJ0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJidG4tdmlkZW8tc3RhcnRcIik7XHJcbiAgbGV0IGJ0blN0b3AgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJ0bi12aWRlby1zdG9wXCIpO1xyXG4gIGxldCBjYWxsQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J0bi12aWRlby1jYWxsJylcclxuICBsZXQgc2VsZWN0Q2hhbmVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlbGVjdC1ydGMtY2hhbmVsJylcclxuXHJcbiAgXHJcbi8v0LLQvtC30LzQvtC20L3Ri9C1INC+0LPRgNCw0L3QuNGH0LXQvdC40Y9cclxuICBsZXQgY29uc3RyYWludHMgPSB7XHJcbiAgICB2aWRlbzoge2FkdmFuY2VkOlt7aGVpZ2h0OiAxNTB9XSwgaGVpZ2h0OiAzMDAsIHdpZHRoOiAzMDB9LFxyXG4gICAgYXVkaW86IHRydWVcclxuICB9O1xyXG5cclxuICBsZXQgaWNlU2VydmVycyA9IFt7XHJcbiAgICAgIHVybHM6IFwidHVybjpib3QucnVpdGIucnU6NTM0OT90cmFuc3BvcnQ9dGNwXCIsXHJcbiAgICAgIHVzZXJuYW1lOiBcInRlbGVtZWQxXCIsXHJcbiAgICAgIGNyZWRlbnRpYWw6IFwiTG9td2U2NzVEZlwiLFxyXG4gICAgICBjcmVkZW50aWFsVHlwZTogXCJwYXNzd29yZFwiXHJcbiAgICB9LFxyXG4gICAgeyB1cmxzOiBcInN0dW46c3R1bi5zdHVucHJvdG9jb2wub3JnXCIgfSxcclxuICAgIHtcclxuICAgICAgdXJsczogXCJ0dXJuOmJvdC5ydWl0Yi5ydTo1MzQ5XCIsXHJcbiAgICAgIHVzZXJuYW1lOiBcInRlbGVtZWQxXCIsXHJcbiAgICAgIGNyZWRlbnRpYWw6IFwiTG9td2U2NzVEZlwiLFxyXG4gICAgICBjcmVkZW50aWFsVHlwZTogXCJwYXNzd29yZFwiLFxyXG4gICAgfSx7XHJcbiAgICAgIHVybHM6IFwidHVybjpib3QucnVpdGIucnU6MzQ3OFwiLFxyXG4gICAgICB1c2VybmFtZTogXCJ0ZWxlbWVkMVwiLFxyXG4gICAgICBjcmVkZW50aWFsOiBcIkxvbXdlNjc1RGZcIixcclxuICAgICAgY3JlZGVudGlhbFR5cGU6IFwicGFzc3dvcmRcIixcclxuICAgIH0se1xyXG4gICAgICB1cmxzOiBcInN0dW46Ym90LnJ1aXRiLnJ1OjM0NzhcIixcclxuICAgICAgdXNlcm5hbWU6IFwidGVsZW1lZDFcIixcclxuICAgICAgY3JlZGVudGlhbDogXCJMb213ZTY3NURmXCIsXHJcbiAgICAgIGNyZWRlbnRpYWxUeXBlOiBcInBhc3N3b3JkXCIsXHJcbiAgICB9XHJcbiAgXTtcclxuXHJcbiAgbGV0IGRpc2Nvbm5lY3Q7XHJcbiAgbGV0IGNvbm5lY3Rpb24gPSB0cnVlO1xyXG5cclxuICBidG5TdGFydC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4geyBjb25uZWN0aW9uICYmIHAycENvbm5lY3QoKSB9KTtcclxuICBidG5TdG9wLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9PnsgKHR5cGVvZiBkaXNjb25uZWN0ID09PSAnZnVuY3Rpb24nKSAmJiBkaXNjb25uZWN0KCk7IGNvbm5lY3Rpb24gPSB0cnVlOyB9KVxyXG5cclxuLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xyXG4vKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXHJcblxyXG4gIGFzeW5jIGZ1bmN0aW9uIHAycENvbm5lY3QoKSB7XHJcbiAgICBjb25uZWN0aW9uID0gZmFsc2U7XHJcbiAgICBsZXQgcGVlckNvbm5lY3Rpb24gPSBjcmVhdGVDb25uZWN0UDJQKCk7XHJcbiAgICBsZXQgc29ja2V0ID0gY3JlYXRlV2ViU29ja2V0Q29ubmVjdChwZWVyQ29ubmVjdGlvbik7XHJcblxyXG4gIFxyXG4gICAgbGV0IG1lZGlhU3RyZWFtID0gYXdhaXQgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoe3ZpZGVvOiB7YnJpZ2h0bmVzczogMjAwLGhlaWdodDogNTAwfSwgYXVkaW86IHRydWV9KTtcclxuICAgIGxldCB0cmFja3MgPSBtZWRpYVN0cmVhbS5nZXRUcmFja3MoKTtcclxuXHJcbiAgICAvLyBsb2NhbFZpZGVvLnNyY09iamVjdCA9IG1lZGlhU3RyZWFtO1xyXG4gICAgLy8gdHJhY2tzLmZvckVhY2godHJhY2sgPT4gcGVlckNvbm5lY3Rpb24uYWRkVHJhY2sodHJhY2ssIG1lZGlhU3RyZWFtKSk7XHJcbiAgIFxyXG4gICAgZGlzY29ubmVjdCA9IGZ1bmN0aW9uKCl7IFxyXG4gICAgICBzb2NrZXQuY2xvc2UoKTtcclxuICAgICAgdHJhY2tzLmZvckVhY2goKHRyYWNrKSA9PiB0cmFjay5zdG9wKCkpO1xyXG4gICAgICBwZWVyQ29ubmVjdGlvbi5jbG9zZSgpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgfVxyXG5cclxuXHJcbiAgZnVuY3Rpb24gY3JlYXRlQ29ubmVjdFAyUCgpIHtcclxuXHJcbiAgICBsZXQgcGVlckNvbm5lY3Rpb24gPSBuZXcgUlRDUGVlckNvbm5lY3Rpb24oeyBpY2VTZXJ2ZXJzLCBpY2VUcmFuc3BvcnRQb2xpY3k6ICdyZWxheSd9KTtcclxuICAgIGxldCBkYXRhQ2hhbmVsID0gcGVlckNvbm5lY3Rpb24uY3JlYXRlRGF0YUNoYW5uZWwoJ3Rlc3RDaGFuZWwnKTtcclxuICAgIFxyXG4gICAgcGVlckxpc3RlbihwZWVyQ29ubmVjdGlvbiwgZGF0YUNoYW5lbCwgcmVtb3RlVmlkZW8pO1xyXG4gICAgcmV0dXJuIHBlZXJDb25uZWN0aW9uO1xyXG4gIH1cclxuXHJcblxyXG4gIGZ1bmN0aW9uIHBlZXJMaXN0ZW4gKHBlZXJDb25uZWN0aW9uLCBkYXRhQ2hhbmVsLCBlbFJlbW90ZVZpZGVvKSB7XHJcbiAgICBkYXRhQ2hhbmVsLmFkZEV2ZW50TGlzdGVuZXIoJ29wZW4nLCAoZSkgPT4geyBjb25zb2xlLmRpcign0JrQsNC90LDQuyBwMnAg0L7RgtC60YDRi9GCJyk7IH0pO1xyXG4gICAgZGF0YUNoYW5lbC5hZGRFdmVudExpc3RlbmVyKCdjbG9zZScsIChlKSA9PiB7IGNvbnNvbGUuZGlyKCfQmtCw0L3QsNC7IHAycCDQt9Cw0LrRgNGL0YInKTsgfSk7XHJcbiAgICBkYXRhQ2hhbmVsLmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCAoZSkgPT4geyBjb25zb2xlLmxvZygnTWVzc2FnZSDQv9C+IHAycDogJywgZS5kYXRhKTsgfSk7XHJcblxyXG4gICAgcGVlckNvbm5lY3Rpb24uYWRkRXZlbnRMaXN0ZW5lcignZGF0YWNoYW5uZWwnLCAoZSkgPT4geyBjb25zb2xlLmRpcign0J/QtdGA0LXQtNCw0YfQsCDQutCw0L3QsNC70LAnKTsgfSlcclxuICAgIHBlZXJDb25uZWN0aW9uLmFkZEV2ZW50TGlzdGVuZXIoJ3RyYWNrJywgKGUpID0+IHsgY29uc29sZS5sb2coJ9Cf0L7Qu9GD0YfQtdC90LjQtSB2aWRlb1RyYWNrJywgZSk7XHJcbiAgICAgIGVsUmVtb3RlVmlkZW8uc3JjT2JqZWN0ID0gZS5zdHJlYW1zWzBdO1xyXG4gICAgfSlcclxuICAgIFxyXG4gICAgcGVlckNvbm5lY3Rpb24uYWRkRXZlbnRMaXN0ZW5lcignbmVnb3RpYXRpb25uZWVkZWQnLCAoZSkgPT4geyBjb25zb2xlLmxvZygn0J/QtdGA0LXQs9C+0LLQvtGA0YsgcDJwJywgZSk7IH0pICAgICBcclxuICB9XHJcblxyXG4vKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXHJcblxyXG4gIGZ1bmN0aW9uIGNyZWF0ZVdlYlNvY2tldENvbm5lY3QocGVlckNvbm5lY3Rpb24pe1xyXG4gICAgXHJcbiAgICBsZXQgc29ja2V0ID0gbmV3IFdlYlNvY2tldChcIndzOi8vbG9jYWxob3N0OjQwMDBcIik7XHJcbiAgICBsZXQgY2xpZW50SWQgPSB1dWlkNCgpOyAgICAgLy8gY2FsbGVyIC0g0LLRi9C30YvQstCw0Y7RidC40LksIGNhbGxlZSAtINCy0YvQt9GL0LLQsNC10LzRi9C5XHJcblxyXG4gICAgY29uc3Qgc2VuZFdTID0gKHBheWxvYWQpID0+IHsgc29ja2V0LnNlbmQoSlNPTi5zdHJpbmdpZnkocGF5bG9hZCkpIH1cclxuICAgIFxyXG4gICAgZnVuY3Rpb24gdG9nZ2xlQ2hhbmVsKGUpe1xyXG4gICAgICBzZW5kV1MoeyB0eXBlOiAndXBkYXRlQ2hhbmVsJywgY2xpZW50SWQsIHJvb206IHNlbGVjdENoYW5lbC52YWx1ZSB9KTtcclxuICAgIH1cclxuICAgXHJcblxyXG4gICAgc29ja2V0LmFkZEV2ZW50TGlzdGVuZXIoJ2Nsb3NlJywgKGUpID0+IHsgY29uc29sZS5sb2coJ9Ch0L7QtdC00LjQvdC10L3QuNC1INGBINGB0LXRgNCy0LXRgNC+0LwgV1Mg0YDQsNC30L7RgNCy0LDQvdC+Jyk7IHNlbGVjdENoYW5lbC5yZW1vdmVFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCB0b2dnbGVDaGFuZWwpOyB9KTsvL1xyXG4gICAgc29ja2V0LmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgKGUpID0+IHsgY29uc29sZS5sb2coJ9Ce0YjQuNCx0LrQsCDRgdC+0LXQtNC40L3QtdC90LjRjyDRgSDRgdC10YDQstC10YDQvtC8IFdTINGA0LDQt9C+0YDQstCw0L3QvicpOyB9KTtcclxuICAgIHNvY2tldC5hZGRFdmVudExpc3RlbmVyKCdlcnJvcicsIChlKSA9PiB7IGNvbnNvbGUubG9nKCfQntGI0LjQsdC60LAg0YHQvtC10LTQuNC90LXQvdC40Y8g0YEg0YHQtdGA0LLQtdGA0L7QvCBXUyDRgNCw0LfQvtGA0LLQsNC90L4nKTsgfSk7XHJcblxyXG4gICAgc29ja2V0LmFkZEV2ZW50TGlzdGVuZXIoJ29wZW4nLCAgKGUpID0+IHtcclxuICAgICAgXHJcbiAgICAgIGNvbnNvbGUubG9nKCfQodC+0LXQtNC40L3QtdC90LjQtSDRgSDRgdC10YDQstC10YDQvtC8IFdTINGD0YHRgtCw0L3QvtCy0LvQtdC90L3QvicpOyBcclxuICAgICAgXHJcbiAgICAgIFxyXG4gICAgICBjb25zb2xlLmxvZyhjbGllbnRJZCwgJ2NsaWVudElkJyk7XHJcbiAgICAgXHJcbiAgICAgIHNlbmRXUyh7IHR5cGU6ICdwZWVyJywgY2xpZW50SWQsIHJvb206IHNlbGVjdENoYW5lbC52YWx1ZSB9KTtcclxuXHJcbiAgICAgIGNyZWF0ZVdlYlNvY2tldENvbm5lY3RUZXN0KHBlZXJDb25uZWN0aW9uLCBzb2NrZXQsIHNlbmRXUylcclxuICAgICBcclxuICAgICAgc2VsZWN0Q2hhbmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHRvZ2dsZUNoYW5lbClcclxuICAgICAgXHJcbiAgICB9KVxyXG5cclxuICAgIFxyXG4gICAgcmV0dXJuIHNvY2tldDtcclxuICB9XHJcblxyXG5cclxuICBmdW5jdGlvbiBjcmVhdGVXZWJTb2NrZXRDb25uZWN0VGVzdCAocGVlckNvbm5lY3Rpb24sIHNvY2tldCwgc2VuZFdTKSB7XHJcblxyXG5cclxuICAgIHBlZXJDb25uZWN0aW9uLm9ubmVnb3RpYXRpb25uZWVkZWQgPSBhc3luYyAoKSA9PiB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgcGVlckNvbm5lY3Rpb24uc2V0TG9jYWxEZXNjcmlwdGlvbihhd2FpdCBwZWVyQ29ubmVjdGlvbi5jcmVhdGVPZmZlcigpKTtcclxuICAgICAgICBjb25zb2xlLmRpcihwZWVyQ29ubmVjdGlvbi5sb2NhbERlc2NyaXB0aW9uKTtcclxuICAgICAgICBzZW5kV1Moe2Rlc2M6IHBlZXJDb25uZWN0aW9uLmxvY2FsRGVzY3JpcHRpb259KTtcclxuICAgICAgICBcclxuICAgICAgfSBjYXRjaCAoZXJyKSB7IGNvbnNvbGUuZXJyb3IoZXJyKTsgfVxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgXHJcbiAgICBwZWVyQ29ubmVjdGlvbi5vbmljZWNhbmRpZGF0ZSA9ICh7Y2FuZGlkYXRlfSkgPT4gc2VuZFdTKHtjYW5kaWRhdGV9KTtcclxuICAgIHBlZXJDb25uZWN0aW9uLm9udHJhY2sgPSAoZXZlbnQpID0+IHsgKCFyZW1vdGVWaWV3LnNyY09iamVjdCkgJiYgKHJlbW90ZVZpZXcuc3JjT2JqZWN0ID0gZXZlbnQuc3RyZWFtc1swXSk7IH07XHJcblxyXG5cclxuICAgIHNvY2tldC5vbm1lc3NhZ2UgPSBhc3luYyAoe2Rlc2MsIGNhbmRpZGF0ZX0pID0+IHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBpZiAoZGVzYykge1xyXG5cclxuICAgICAgICAgIHN3aXRjaCAoZGVzYy50eXBlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ29mZmVyJzogXHJcbiAgICAgICAgICAgICAgY29uc3Qgc3RyZWFtID0gYXdhaXQgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoe3ZpZGVvOiB0cnVlLCBhdWRpbzogdHJ1ZX0pO1xyXG4gICAgICAgICAgICAgIHN0cmVhbS5nZXRUcmFja3MoKS5mb3JFYWNoKCh0cmFjaykgPT4gcGVlckNvbm5lY3Rpb24uYWRkVHJhY2sodHJhY2ssIHN0cmVhbSkpO1xyXG4gICAgICAgICAgICAgIGNyZWF0ZU9mZmVyKCk7ICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdhbnN3ZXInOiAgYXdhaXQgcGVlckNvbm5lY3Rpb24uc2V0UmVtb3RlRGVzY3JpcHRpb24oZGVzYyk7ICBicmVhaztcclxuICAgICAgICAgICAgZGVmYXVsdDogY2FuZGlkYXRlICYmIGF3YWl0IHBjLmFkZEljZUNhbmRpZGF0ZShjYW5kaWRhdGUpOyBicmVhaztcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0gY2F0Y2ggKGVycikgeyBjb25zb2xlLmVycm9yKGVycik7IH1cclxuICAgIH07XHJcblxyXG5cclxuICAgIGNvbnN0IGNyZWF0ZU9mZmVyID0gYXN5bmMgKHBjLCBzZW5kV1MsIGRlc2MpID0+IHtcclxuICAgICAgYXdhaXQgcGMuc2V0UmVtb3RlRGVzY3JpcHRpb24oZGVzYyk7XHJcbiAgICAgIGF3YWl0IHBjLnNldExvY2FsRGVzY3JpcHRpb24oYXdhaXQgcGMuY3JlYXRlQW5zd2VyKCkpO1xyXG4gICAgICBzZW5kV1Moe2Rlc2M6IHBjLmxvY2FsRGVzY3JpcHRpb259KTtcclxuICAgIH1cclxuXHJcbiAgfVxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4gXHJcbn0pXHJcblxyXG5cclxuXHJcbi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4vKlxyXG4gIEJsb2Ig0LzQvtC20L3QviDQv9GA0LXQstGA0LDRgtC40YLRjCDQsiBVUkwg0YLQsNC60L7Qs9C+INCy0LjQtNCwOlxyXG4gIGJsb2I6aHR0cDovLzEyNy4wLjAuMTo1NTAwL2FjNjdkNTljLTNlMDItNGNiMi1hMGRmLTMzYTUzYWZlZWIyY1xyXG5cclxuICDQodC/0L7RgdC+0LEg0YHQtNC10LvQsNGC0Ywg0YTQvtGC0L4g0YEg0LrQsNC80LXRgNGLOlxyXG4gICAgICBsZXQgY2FwdHVyZSA9IG5ldyBJbWFnZUNhcHR1cmUodmlkZW9UcmFjayk7XHJcbiAgICAgIGNhcHR1cmUudGFrZVBob3RvKCkudGhlbihhc3luYyAoYmxvYik9PntcclxuICAgICAgICBsZXQgb2JqZWN0VVJMID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTtcclxuICAgICAgICBjb25zb2xlLmRpcihvYmplY3RVUkwpO1xyXG4gICAgICAgIGVsSW1nLnNldEF0dHJpYnV0ZSgnc3JjJywgb2JqZWN0VVJMKVxyXG4gICAgICB9KVxyXG4qL1xyXG5cclxuXHJcblxyXG5cclxuXHJcbi8qIyMjIyMjIyMjLS0tLS0tLS08eyBXZWJTb2NrZWQgfT4tLS0tLS0jIyMjIyMjIFxyXG5leHRlbnNpb25zOiBcIlwiXHJcbm9uY2xvc2U6IG51bGxcclxub25lcnJvcjogbnVsbFxyXG5vbm1lc3NhZ2U6IG51bGxcclxub25vcGVuOiBudWxsLy/QvtGC0YDQsNCx0LDRgtGL0LLQsNC10YIg0LXRgdC70Lgg0LXRgdGC0Ywg0L/QvtC00LrQu9GO0YfQtdC90LjQtSDQuiB3cyDRgdC10YDQstC10YDRg1xyXG4vL9C80LXRgtC+0LTRi1xyXG5zZW5kXHJcbmNsb3NlXHJcbiovXHJcblxyXG5cclxuXHJcblxyXG5cclxuLy8gZnVuY3Rpb24gY3JlYXRlV2ViU29ja2V0Q29ubmVjdChwZWVyQ29ubmVjdGlvbil7XHJcblxyXG4vLyAgIGxldCBzb2NrZXQgPSBuZXcgV2ViU29ja2V0KFwid3M6Ly9sb2NhbGhvc3Q6NDAwMFwiKTtcclxuLy8gICBzb2NrZXQuYWRkRXZlbnRMaXN0ZW5lcignY2xvc2UnLCAoZSkgPT4geyBjb25zb2xlLmxvZygn0KHQvtC10LTQuNC90LXQvdC40LUg0YEg0YHQtdGA0LLQtdGA0L7QvCBXUyDRgNCw0LfQvtGA0LLQsNC90L4nKTsgfSk7XHJcbi8vICAgc29ja2V0LmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgKGUpID0+IHsgY29uc29sZS5sb2coJ9Ce0YjQuNCx0LrQsCDRgdC+0LXQtNC40L3QtdC90LjRjyDRgSDRgdC10YDQstC10YDQvtC8IFdTINGA0LDQt9C+0YDQstCw0L3QvicpOyB9KTtcclxuLy8gICBzb2NrZXQuYWRkRXZlbnRMaXN0ZW5lcignb3BlbicsICAoZSkgPT4ge1xyXG4vLyAgICAgY29uc29sZS5sb2coJ9Ch0L7QtdC00LjQvdC10L3QuNC1INGBINGB0LXRgNCy0LXRgNC+0LwgV1Mg0YPRgdGC0LDQvdC+0LLQu9C10L3QvdC+Jyk7IFxyXG4vLyAgICAgbGV0IGNsaWVudElkID0gdXVpZDQoKTsgICAgIC8vIGNhbGxlciAtINCy0YvQt9GL0LLQsNGO0YnQuNC5LCBjYWxsZWUgLSDQstGL0LfRi9Cy0LDQtdC80YvQuVxyXG4gXHJcbi8vICAgICBjb25zb2xlLmxvZyhjbGllbnRJZCwgJ2NsaWVudElkJyk7XHJcbi8vICAgICBjb25zdCBzZW5kV1MgPSAocGF5bG9hZCkgPT4geyBzb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeShwYXlsb2FkKSkgfVxyXG4vLyAgICAgc2VuZFdTKHsgdHlwZTogJ3BlZXInLCBjbGllbnRJZCwgcm9vbTogJycgfSk7XHJcblxyXG4vLyAgICAgcGVlckNvbm5lY3Rpb24uYWRkRXZlbnRMaXN0ZW5lcignaWNlY2FuZGlkYXRlJywgKGUpID0+IHtcclxuLy8gICAgICAgKGUuY2FuZGlkYXRlKSAmJiBzZW5kV1MoeyB0eXBlOiAnY2FuZGlkYXRlJywgY2FuZGlkYXRlOiBlLmNhbmRpZGF0ZSB9KTtcclxuLy8gICAgIH0pXHJcblxyXG5cclxuLy8gICAgIHNvY2tldC5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgYXN5bmMgKHtkYXRhLCAuLi5lfSkgPT4ge1xyXG4vLyAgICAgICBkYXRhID0gSlNPTi5wYXJzZShkYXRhKTtcclxuXHJcbi8vICAgICAgIHN3aXRjaCAoZGF0YS50eXBlKSB7XHJcbi8vICAgICAgICAgY2FzZSAncGVlcic6IChkYXRhLmNsaWVudElkICE9PSBjbGllbnRJZCkgJiYgc2VuZFdTKHt0eXBlOiAnaW5pdElEJywgY2FsbGVyOiBjbGllbnRJZCwgY2FsbGVlOiBkYXRhLmNsaWVudElkIH0pOyBicmVhaztcclxuLy8gICAgICAgICBjYXNlICdpbml0SUQnOiAoZGF0YS5jYWxsZXIgPT09IGNsaWVudElkKSAmJiBjcmVhdGVPZmZlcihwZWVyQ29ubmVjdGlvbiwgc2VuZFdTLCBkYXRhKTsgYnJlYWs7ICAgICAgICAgIFxyXG4vLyAgICAgICAgIGNhc2UgJ2NhbmRpZGF0ZSc6IHBlZXJDb25uZWN0aW9uLmFkZEljZUNhbmRpZGF0ZShkYXRhLmNhbmRpZGF0ZSk7IGJyZWFrOyAgICAgIFxyXG4vLyAgICAgICAgIGNhc2UgJ29mZmVyJzogKGRhdGEuY2FsbGVlID09PSBjbGllbnRJZCkgJiYgY3JlYXRlQW5zd2VyKHBlZXJDb25uZWN0aW9uLCBzZW5kV1MsIGRhdGEpOyBicmVhaztcclxuLy8gICAgICAgICBjYXNlICdhbnN3ZXInOiAoZGF0YS5jYWxsZXIgPT09IGNsaWVudElkKSAmJiBwZWVyQ29ubmVjdGlvbi5zZXRSZW1vdGVEZXNjcmlwdGlvbihkYXRhKTsgYnJlYWs7XHJcbi8vICAgICAgICAgZGVmYXVsdDogYnJlYWs7XHJcbi8vICAgICAgIH1cclxuXHJcbi8vICAgICB9KVxyXG5cclxuLy8gICB9KVxyXG5cclxuLy8gfVxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuZnVuY3Rpb24gdXVpZDQoKSB7XHJcbiAgZnVuY3Rpb24gaGV4KHMsIGIpIHtcclxuICAgICAgcmV0dXJuIHMgK1xyXG4gICAgICAgICAgKGIgPj4+IDQpLnRvU3RyaW5nKDE2KSArIC8vIGhpZ2ggbmliYmxlXHJcbiAgICAgICAgICAoYiAmIDBiMTExMSkudG9TdHJpbmcoMTYpOyAvLyBsb3cgbmliYmxlXHJcbiAgfVxyXG5cclxuICB2YXIgciA9IGNyeXB0by5nZXRSYW5kb21WYWx1ZXMobmV3IFVpbnQ4QXJyYXkoMTYpKTtcclxuXHJcbiAgcls2XSA9IHJbNl0gPj4+IDQgfCAwYjAxMDAwMDAwOyAvLyBTZXQgdHlwZSA0OiAwMTAwXHJcbiAgcls4XSA9IHJbOF0gPj4+IDMgfCAwYjEwMDAwMDAwOyAvLyBTZXQgdmFyaWFudDogMTAwXHJcblxyXG4gIHJldHVybiByLnNsaWNlKDAsIDQpLnJlZHVjZShoZXgsICcnKSArXHJcbiAgICAgIHIuc2xpY2UoNCwgNikucmVkdWNlKGhleCwgJy0nKSArXHJcbiAgICAgIHIuc2xpY2UoNiwgOCkucmVkdWNlKGhleCwgJy0nKSArXHJcbiAgICAgIHIuc2xpY2UoOCwgMTApLnJlZHVjZShoZXgsICctJykgK1xyXG4gICAgICByLnNsaWNlKDEwLCAxNikucmVkdWNlKGhleCwgJy0nKTtcclxufSJdfQ==
